# Release Notes: Project 11 (Rerank & Cache)

**Дата:** 2026-01-14
**Версия:** Project 11 Implementation

Это обновление направлено на улучшение качества поиска и производительности системы Docs Q&A RAG.

## Новые Возможности

### 1. Reranking (Переранжирование)
Внедрен второй этап поиска для повышения релевантности ответов.
*   **Как это работает**: После получения списка кандидатов (Hybrid Search + RRF), система берет Топ-N результатов (по умолчанию 10) и отправляет их в LLM с инструкцией "оцени релевантность этого фрагмента вопросу".
*   **Результат**: LLM сортирует список, и наиболее подходящие фрагменты попадают в контект для генерации ответа. Менее релевантные отсеиваются.
*   **Настройка**: Управляется переменными `RERANK_ENABLED` и `RERANK_TOP_N`.

### 2. Caching (Кеширование)
Добавлено In-Memory кеширование для мгновенных ответов на повторяющиеся вопросы.
*   **Стратегия**: LRU (Least Recently Used) + TTL (Time To Live).
*   **Ключ кеша**: Хеш от (нормализованный вопрос + ID выбранных документов + версия конфига).
*   **Эффект**: Если задать тот же вопрос повторно (в течение 10 минут), ответ вернется за <1мс без обращения к базе данных и LLM.
*   **Настройка**: `CACHE_ENABLED`, `CACHE_TTL_SECONDS`, `CACHE_MAX_ITEMS`.

### 3. Observability (Наблюдаемость)
В логи сервера добавлены подробные метрики производительности:
*   Время выполнения каждого этапа (`Retrieval`, `Rerank`, `Generation`).
*   Мини-отчеты о найденных кандидатах (до и после переранжирования).
*   Статистика попаданий в кеш (`Cache Hits/Misses`).

## Изменения в конфигурации
Добавлены новые переменные окружения в `.env`:
*   `RETRIEVAL_TOP_K`
*   `RERANK_ENABLED`, `RERANK_TOP_N`
*   `CACHE_ENABLED`, `CACHE_TTL_SECONDS`, `CACHE_MAX_ITEMS`

## Инструкции по обновлению
1.  Обновите код из репозитория.
2.  Добавьте новые переменные в ваш `.env` файл (см. `.env.example`).
3.  Перезапустите приложение.
